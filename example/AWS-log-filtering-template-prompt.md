### 목적:
AWS/DevOps 로그 또는 비용 로그에서 **단순 필터가 아닌 고정밀 조건 기반으로 중요 로그만 추출**하고 싶습니다.

단순한 조건 필터링이 아닌 다음과 같은 고급 구조를 포함해주세요:

---

### 필터링 로직 요구사항:

1. **다층 조건 기반 중요도 판단**
   - EC2: 활용률이 30% 미만이고 비용이 100 이상이면 중요
   - S3: STANDARD이고 DaysOld가 90일 이상이면 중요
   - CloudWatch 등: 의미 있는 이벤트(`Low utilization`, `Archived`, `High metric`)가 포함된 경우

2. **정책 위반 이벤트 기반 조건**
   - `open to all`, `public S3`, `unauthorized`, `exposed` 등의 텍스트가 Event에 포함되면 높은 중요도 부여

3. **비용 이상값 감지 (통계 기반)**
   - 비용 필드에 대해 Z-score를 적용하여 평균보다 높은 경우 가산점

4. **시간 기반 패턴 고려**
   - 로그가 `Timestamp` 순서일 때, 최근 3시간 내 비용이 2번 이상 증가한 경우 중요

---

### 추가 조건:

- 단일 조건으로 필터링하지 않고, 위 조건들을 모두 `가중치 기반 점수화`해서 누적 점수로 판단
- `점수 >= 3` 이상일 때만 중요 로그로 간주
- 결과는 중요 로그만 추출된 DataFrame으로 반환
- 이후 DSL(+dag) 흐름으로 자동화할 수 있도록 구조적으로 깔끔하게 작성

---

### 출력 예시:

- Python 코드 (pandas 기반)
- `layered_filter(df)` 형식으로 함수화
- 각 조건마다 점수 구조를 명시
- ImportanceScore 열을 기준으로 최종 필터링