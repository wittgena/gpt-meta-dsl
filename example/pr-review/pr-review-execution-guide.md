## ✅ PR 리뷰 자동화 및 DSL 기반 실행 가이드

---

### 🧱 1. PR 변경 파일 추출 (기초 zip 구성)

```bash
./generate-pr-zip.sh <PR_NUMBER>
```

- **기능**: 해당 PR의 변경 파일만 추출하여 `review-pr-<PR_NUMBER>.zip` 생성
- **목적**: GPT에 업로드해 분석에 활용할 수 있도록 변경된 파일만 압축 제공

---

### 📑 2. PR 요약 정보 추출 (리뷰 템플릿 자동 채우기)

```bash
./generate-pr-summary.sh <PR_NUMBER>
```

- **기능**: PR의 기본 정보(title, body, 변경 파일 목록)를 추출하여
- **결과물**: `template-pr-info.txt` 파일 (GPT 템플릿에 붙여넣기 용도)

---

### 💬 3. GPT Web 기반 리뷰 분석 시작

1. `pr_review_template_prompt.md` 파일을 GPT 웹 채팅창에 입력
2. 위의 `template-pr-info.txt` 내용을 복사하여 붙여넣음
3. `review-pr-<PR_NUMBER>.zip` 파일 업로드
4. **GPT에게 다음과 같이 명령**:

```
이 템플릿을 기준으로 이 PR에 대한 리뷰를 생성해주세요.
```

---

### 🧠 4. 이후 분석은 자연어 또는 DSL 기반 명령으로 수행

#### ✅ 자연어 예시

- "getBySearchLog 병행 호출 구조가 문제될 수 있는지 분석해줘"
- "테스트가 부족한 부분이 있다면 알려줘"

#### ✅ DSL 명령어 기반 예시

| DSL 명령어     | 역할                                                  |
|----------------|-------------------------------------------------------|
| `+critic:`     | 특정 대상 또는 구조에 대해 비판적 분석 요청           |
| `+eval:`       | 구조적 적절성, 운영 안정성, 설계 정합성 등을 평가     |
| `+val:`        | 설계 방향성 또는 리팩토링 제안에 대한 논리적 가치 검토|
| `+refactor:`   | 코드 리팩토링 방향 구체화 요청 (위치, 클래스, 전략 포함) |
| `+simulation:` | 테스트/실행 시나리오 흐름 검증 요청 (fallback 등)     |
| `+update:`     | 이전 리뷰 반영 후 다시 갱신 요청                      |

예시 입력:
```
+critic: RedisKeywordFetcher 구조 검토
+refactor: KeywordFetcher를 전략 패턴으로 전환
+simulation: fallback 동작 시 테스트 케이스 생성
```

> 각 명령은 GPT가 해당 context에 맞는 DSL 흐름을 재구성하고 문서 또는 테스트/코드 예시로 반환

---

### 📦 결과물 구성 및 후속 작업

- 분석 결과는 GPT가 자동으로 `__this.prreview.md`, `__this.prreview2.md`, ... 형태로 저장
- 이후에는 아래와 같은 후속 명령 수행 가능:

| 명령             | 설명                                          |
|------------------|-----------------------------------------------|
| `+md파일 다운로드` | 리뷰 결과를 Markdown 파일로 저장함             |
| `+merge:`         | 여러 리뷰 결과를 하나로 병합함                 |
| `+blog:`          | 결과를 기술 블로그용 포맷으로 변환             |
| `+script:`        | 전체 과정을 자동화하는 쉘 스크립트 생성       |

---

## ✅ 최종 구성 요약

| 구성 요소       | 생성물                    | 설명                                  |
|----------------|---------------------------|---------------------------------------|
| PR 변경파일 압축 | `review-pr-<PR>.zip`       | 분석 대상 코드 파일 묶음              |
| PR 정보 요약    | `template-pr-info.txt`     | GPT 입력용 기본 요약                  |
| 리뷰 템플릿     | `pr_review_template_prompt.md` | GPT에 붙여넣는 리뷰 요청용 서식     |
| 리뷰 결과       | `__this.prreview*.md`      | 분석 결과 문서화 형태                 |
| 명령어 기반 흐름| `+critic`, `+eval`, `+refactor`, `+val`, `+simulation` | DSL 기반 리뷰 흐름 제어 |

---

이 가이드는 PR 분석 자동화 및 GPT 리뷰 기반 구조화 작업을 위한 정형 프로세스를 구성하며, 
자연어와 DSL을 병행하여 구조적 코드 평가 및 개선 흐름을 반복 수행할 수 있게 합니다.